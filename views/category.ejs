<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= category %> | Product Category</title>
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/category.css">
</head>

<body>
    <header id="headerbar">
        <header id="headerbar">
            <div class="title-bar">
              <div class="head-left">
                <img src="assets/file.png" alt="logo" id="logo">
                <h1 class="company-title lato-bold">Something Little Special</h1>
                <input type="text" name="searchbar" id="searchbar" placeholder="Search...">
              </div>
              <div class="head-right">
                <button class="icon-button" onclick="window.location.href='h'"><img src="assets/wishlist.png" alt=""
                    class="large-icon" title="View Wishlist"></button>
                <button class="icon-button" onclick="window.location.href='h'"><img src="assets/shopping-cart.png" alt=""
                    class="large-icon" title="View Cart"></button>
          
                <% if (isAuthenticated) { %>
                  <!-- Header after login -->
                  <div class="acc-dropdown">
                    <button class="icon-button"><img src="assets/account.png" alt="" class="large-icon" onclick="window.location.href='/profile'"></button>
                  </div>            
                <% } else { %>
                  <!-- Header before login -->
                  <div class="acc-dropdown">
                        <button class="icon-button"><img src="assets/account.png" alt="" class="large-icon"></button>
                        <div class="acc-dropdown-content">
                            <button onclick="document.getElementById('cloginform').style.display='block'">Customer</button>
                        </div>
                    </div>
                <% } %>
              </div>
            </div>
          
            <!-- Login Modal -->
            <% if (!isAuthenticated) { %>
                <div class="modal-container" id="cloginform">
                    <div class="center animate">
                        <div class="login-title">
                            <h2>Login</h2>
                        </div>
                        <div class="formpage">
                            <div   class="lato-regular">
                                <div class="btn">
                                    <button id="c-login"><img src="assets/google-icon.png" alt=""
                                            id="google-logo">Continue with Google</button>
                                    <button type="button" onclick="closePopup()"
                                        class="cancelbtn">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            <% } %>
    </header>

    <div class="empty-bar"></div>

    <div class="container">
        <div class="filters-sidebar">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <div class="sort-options">
                Sort by:
                <div class="sort-options-buttons">
                    <button>Popularity</button>
                    <button>Price: Low to High</button>
                    <button>Price: High to Low</button>
                    <button>Latest</button>
                    <button>Oldest</button>
                </div>
            </div>
            <div class="price-filters">
                <div class="min-price-filters">
                    <label for="minPrice">Min Price</label>
                    <input type="number" id="minPrice">
                </div>
                <div class="max-price-filters">
                    <label for="maxPrice">Max Price</label>
                    <input type="number" id="maxPrice">
                </div>
            </div>
            <div class="customization-filters">
                Customizable?
                <div class="customization-options">
                    <label><input type="checkbox" name="customizability-filters" class="single-checkbox" value="custom-yes"> Yes</label>
                    <label><input type="checkbox" name="customizability-filters" class="single-checkbox" value="custom-no"> No</label>
                </div>
            </div>

            <div class="rating-filters">
                Filter by ratings:
                <div class="rating-options">
                    <label><input type="checkbox" name="rating-filters" value="rating-three-star">3 stars and above</label>
                    <label><input type="checkbox" name="rating-filters" value="rating-four-star">4 stars and above</label>
                    <label><input type="checkbox" name="rating-filters" value="rating-five-star">5 stars</label>
                </div>
            </div>

            <div class="material-filters">
                Material:
                <div class="material-options">
                    <label><input type="checkbox" name="material-filters" value="material-wood">Wood</label>
                    <label><input type="checkbox" name="material-filters" value="material-resin">Resin</label>
                    <label><input type="checkbox" name="material-filters" value="material-glass">Glass</label>
                    <label><input type="checkbox" name="material-filters" value="material-acrylic">Acrylic</label>
                    <label><input type="checkbox" name="material-filters" value="material-others">Others</label>
                </div>
            </div>

            <div class="filter-buttons">
                <button type="reset">Clear Filters</button>
                <button type="submit">Apply Filters</button>
            </div>
        </div>

        <!-- Product display part -->
        <div class="product-box">
            <h2><%= category %></h2>
            <p><%= description %></p>

            <% if (products && products.length > 0) { %>
                <% products.forEach(product => { %>
                    <div class="product-card">
                        <div class="product-images">
                            <img src="<%= product.coverImage %>" alt="<%= product.name %>" width="250px" height="250px">
                            <div class="fav-icon-div">
                                <img src="/assets/favourite.png" alt="Favorite">
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-name-div">
                                <p class="product-name"><%= product.name %></p>
                            </div>
                            <div class="product-desc">
                                <div class="product-desc-row">
                                    <p class="product-price">â‚¹ <%= product.price %></p>
                                    <p class="product-rating">Rating Stars</p>
                                </div>
                                <div class="product-customization-row">
                                    <% if (product.isCustomizable) { %>
                                        <span class="custom-icon-box">
                                            <img src="/assets/customize-icon.png" alt="Customizable" width="16px">
                                        </span>
                                        <span class="customize-info"><em>Customizable</em></span>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                    </div>
                <% }); %>
            <% } else { %>
                <p>No products found in this category.</p>
            <% } %>
        </div>
    </div>

    <footer>
        
    </footer>
</body>

<script>
    document.getElementById('c-login').addEventListener('click', function() {
    // Redirect to the Google OAuth route
    window.location.href = '/auth/google';
  });
 
    //Modal Script (Popup)
    window.onclick = function (event) {
        var cloginModal = document.getElementById('cloginform');
        var aloginModal = document.getElementById('aloginform');
        var aloginModal = document.getElementById('csignupform');
        if (event.target == cloginModal) {
            cloginModal.style.display = "none";
        } else if (event.target == aloginModal) {
            aloginModal.style.display = "none";
        }
    }

    // Function to show the popup only on the first visit in the current session
    window.onload = function () {
        setTimeout(function () {
            if (!sessionStorage.getItem('popupShown')) {
                // Show the popup if it hasn't been shown in this session
                document.getElementById("cloginform").style.display = "block";
            }
        }, 2000); // Delay of 2000 milliseconds (2 seconds)
    };

    // Function to close the popup
    function closePopup() {
        document.getElementById("cloginform").style.display = "none";
        // Set a flag in sessionStorage to prevent the popup from showing again in this session
        sessionStorage.setItem('popupShown', 'true');
    }


    //Display Slider Value
    // function updateValue(val) {
    //     document.getElementById('range-value').textContent = val;
    // }


    // Customization filter script for selecting single checkbox
    const checkboxes = document.querySelectorAll('.single-checkbox');
    // Attach click event listener to each checkbox
    checkboxes.forEach((checkbox) => {
        checkbox.addEventListener('click', function () {
            checkboxes.forEach((cb) => {
                if (cb !== checkbox) {
                    cb.checked = false;  // Uncheck all other checkboxes
                }
            });
        });
    });


    // Script of Sorting Section
    // function showSortFilters() {
    //     const sortOptions = document.getElementsByClassName("sort-options-buttons")[0];  // Access the first element
    //     sortOptions.classList.toggle("show");
    // }
</script>

</html>















